<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>欢迎页面-WeAdmin Frame型后台管理系统-WeAdmin 1.0</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../static/css/font.css">
    <link rel="stylesheet" href="../static/css/weadmin.css">
</head>

<body>
    <div class="weadmin-body">
        <blockquote class="layui-elem-quote">欢迎使用WeAdmin 后台模版！</blockquote>
        <div class="layui-fluid" style="overflow: hidden;">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-card">
                        <div class="layui-card-header">订单状态统计</div>
                        <div class="layui-card-body">
                            <table id="statsTable" class="layui-table" lay-even>
                                <thead>
                                    <tr>
                                        <th>订单状态</th>
                                        <th>订单数量</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- 数据行将通过JavaScript动态添加 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="text/javascript">
        // 加载数据并渲染表格
        axios.get('http://localhost:8080/order/stats')
    .then(function (response) {
        console.log(response.data); // 调试信息
        if (response.data.code === 200) {
            const data = response.data.data; // 确保 data 是一个数组
            const tableBody = document.getElementById('statsTable').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = ''; // 清空表格内容

            // 检查 data 是否为数组
            if (Array.isArray(data)) {
                data.forEach(item => {
                    const row = tableBody.insertRow();
                    const cell1 = row.insertCell(0);
                    const cell2 = row.insertCell(1);
                    cell1.innerHTML = item.order_status; // 确保字段名正确
                    cell2.innerHTML = item.count; // 确保字段名正确
                });
            } else {
                console.error('数据格式错误:', data);
            }
        } else {
            console.error('没有数据:', response.data.msg); // 使用 msg 字段
        }
    })
    .catch(function (error) {
        console.error('获取数据失败:', error);
    });
    </script>
</body>
</html>